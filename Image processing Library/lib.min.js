function Processor(t){this.width=t.width,this.height=t.height,this.data=void 0,this.pixel=void 0,this.resizeon=!1,this.drawPnt=!1,this.drawPnt1=!1,this.color="black",this.radius=5,this.image=new Image,this.can=t,this.context=t.getContext("2d"),this.effector="light",this.obj={r:255,g:255,b:255,a:255},this.tremor={sharpen:[-1,-1,-1,-1,9,-1,-1,-1,-1],smooth:[1,1,1,1,1,1,1,1,1]},this.addImage=function(t,h){"."!=t[0]&&(this.image.src=t),this.image.onload=function(){this.context.drawImage(this.image,0,0,this.width,this.height),this.data=this.context.getImageData(0,0,this.width,this.height),this.pixel=this.data.data.length/4,h()}.bind(this)},this.getThePix=function(t){this.obj.r=this.data.data[t],this.obj.g=this.data.data[t+1],this.obj.b=this.data.data[t+2],this.obj.a=this.data.data[t+3]},this.colorAll=function(t,h){this.data.data[t]=h,this.data.data[t+1]=h,this.data.data[t+2]=h},this.brightness=function(t){return.33*this.data.data[t]+.5*this.data.data[t+1]+.16*this.data.data[t+2]},this.prevProcess=function(){for(var t=0;t<this.height;t++)for(var h=0;h<this.width;h++){var i=4*(h+t*this.width);this.getThePix(i),"light"==this.effector?this.prevlight():"grayscale"==this.effector?this.prevgray():"crazy"==this.effector?this.prevCrazy():alert("Unknown Effect!"),this.data.data[i]=this.obj.r,this.data.data[i+1]=this.obj.g,this.data.data[i+2]=this.obj.b,this.data.data[i+3]=this.obj.a}},this.prevlight=function(){this.obj.r=this.obj.r+12,this.obj.g=this.obj.g+12,this.obj.b=this.obj.b+17,this.obj.a=2.11*this.obj.a},this.prevgray=function(){grsc=this.obj.r+this.obj.g+this.obj.b,this.obj.r=grsc,this.obj.g=grsc,this.obj.b=grsc,this.obj.a=this.obj.a+11},this.prevCrazy=function(){xcxc=this.obj.r*Math.sin(this.obj.r),this.obj.r=this.obj.g,this.obj.g=xcxc,this.obj.b=this.obj.b},this.sharpener=function(t){this.data.data[t[1][1]]=this.data.data[t[0][0]]*this.tremor.sharpen[0]+this.data.data[t[0][1]]*this.tremor.sharpen[1]+this.data.data[t[0][2]]*this.tremor.sharpen[2]+this.data.data[t[1][0]]*this.tremor.sharpen[3]+this.data.data[t[1][1]]*this.tremor.sharpen[4]+this.data.data[t[1][2]]*this.tremor.sharpen[5]+this.data.data[t[2][0]]*this.tremor.sharpen[6]+this.data.data[t[2][1]]*this.tremor.sharpen[7]+this.data.data[t[2][2]]*this.tremor.sharpen[8],this.data.data[t[1][1]+1]=this.data.data[t[0][0]+1]*this.tremor.sharpen[0]+this.data.data[t[0][1]+1]*this.tremor.sharpen[1]+this.data.data[t[0][2]+1]*this.tremor.sharpen[2]+this.data.data[t[1][0]+1]*this.tremor.sharpen[3]+this.data.data[t[1][1]+1]*this.tremor.sharpen[4]+this.data.data[t[1][2]+1]*this.tremor.sharpen[5]+this.data.data[t[2][0]+1]*this.tremor.sharpen[6]+this.data.data[t[2][1]+1]*this.tremor.sharpen[7]+this.data.data[t[2][2]+1]*this.tremor.sharpen[8],this.data.data[t[1][1]+2]=this.data.data[t[0][0]+2]*this.tremor.sharpen[0]+this.data.data[t[0][1]+2]*this.tremor.sharpen[1]+this.data.data[t[0][2]+2]*this.tremor.sharpen[2]+this.data.data[t[1][0]+2]*this.tremor.sharpen[3]+this.data.data[t[1][1]+2]*this.tremor.sharpen[4]+this.data.data[t[1][2]+2]*this.tremor.sharpen[5]+this.data.data[t[2][0]+2]*this.tremor.sharpen[6]+this.data.data[t[2][1]+2]*this.tremor.sharpen[7]+this.data.data[t[2][2]+2]*this.tremor.sharpen[8]},this.smoothen=function(t){this.data.data[t[1][1]]=(this.data.data[t[0][0]]*this.tremor.smooth[0]+this.data.data[t[0][1]]*this.tremor.smooth[1]+this.data.data[t[0][2]]*this.tremor.smooth[2]+this.data.data[t[1][0]]*this.tremor.smooth[3]+this.data.data[t[1][1]]*this.tremor.smooth[4]+this.data.data[t[1][2]]*this.tremor.smooth[5]+this.data.data[t[2][0]]*this.tremor.smooth[6]+this.data.data[t[2][1]]*this.tremor.smooth[7]+this.data.data[t[2][2]]*this.tremor.smooth[8])/9,this.data.data[t[1][1]+1]=(this.data.data[t[0][0]+1]*this.tremor.smooth[0]+this.data.data[t[0][1]+1]*this.tremor.smooth[1]+this.data.data[t[0][2]+1]*this.tremor.smooth[2]+this.data.data[t[1][0]+1]*this.tremor.smooth[3]+this.data.data[t[1][1]+1]*this.tremor.smooth[4]+this.data.data[t[1][2]+1]*this.tremor.smooth[5]+this.data.data[t[2][0]+1]*this.tremor.smooth[6]+this.data.data[t[2][1]+1]*this.tremor.smooth[7]+this.data.data[t[2][2]+1]*this.tremor.smooth[8])/9,this.data.data[t[1][1]+2]=(this.data.data[t[0][0]+2]*this.tremor.smooth[0]+this.data.data[t[0][1]+2]*this.tremor.smooth[1]+this.data.data[t[0][2]+2]*this.tremor.smooth[2]+this.data.data[t[1][0]+2]*this.tremor.smooth[3]+this.data.data[t[1][1]+2]*this.tremor.smooth[4]+this.data.data[t[1][2]+2]*this.tremor.smooth[5]+this.data.data[t[2][0]+2]*this.tremor.smooth[6]+this.data.data[t[2][1]+2]*this.tremor.smooth[7]+this.data.data[t[2][2]+2]*this.tremor.smooth[8])/9},this.resize=function(t,h){this.resizeon=!0,this.can.addEventListener("mousemove",function(t){this.resizeon&&(this.context.clearRect(0,0,this.width,this.height),this.width=t.clientX,this.height=t.clientY,this.context.drawImage(this.image,0,0,this.width,t.clientY)),this.can.addEventListener("click",function(t){this.resizeon=!1}.bind(this))}.bind(this))},this.draw=function(t){this.drawPnt=!this.drawPnt,this.drawPnt&&(this.can.onclick=function(){this.drawPnt1=!this.drawPnt1}.bind(this),this.can.addEventListener("mousemove",function(t){this.drawPnt&&(this.context.fillStyle=this.color,this.drawPnt1&&(this.context.beginPath(),this.context.arc(t.clientX,t.clientY,this.radius,0,2*Math.PI),this.context.fill()),this.context.closePath())}.bind(this)))}.bind(this),this.effectDone=function(){"pencil"==this.effector?this.pencil():"sharpen"==this.effector?this.sharpen():"smooth"==this.effector?this.smooth():this.prevProcess()}.bind(this),this.effect=function(){this.data=this.context.getImageData(0,0,this.width,this.height),this.pixel=this.data.data.length/4,this.effectDone(),this.context.putImageData(this.data,0,0)}.bind(this),this.pencil=function(){console.log("s"),this.data=this.context.getImageData(0,0,this.width,this.height);for(var t=0;t<this.height-1;t++)for(var h=0;h<this.width-1;h++){var i=4*(h+t*this.width),a=4*(h+1+t*this.width),s=this.brightness(this.data.data[i]),d=this.brightness(this.data.data[a]),o=Math.abs(s-d);o>1?this.colorAll(i,o):this.colorAll(i,255-o)}this.context.putImageData(this.data,0,0)}.bind(this),this.sharpen=function(){this.data=this.context.getImageData(0,0,this.width,this.height);for(var t=1;t<this.height-1;t++)for(var h=1;h<this.width-1;h++){var i=[];i[0]=[4*(h-1-this.width+t*this.width),4*(h-this.width+t*this.width),4*(h+1-this.width+t*this.width)],i[1]=[4*(h-1+t*this.width),4*(h+t*this.width),4*(h+1+t*this.width)],i[2]=[4*(h-1+this.width+t*this.width),4*(h-1+this.width+t*this.width),4*(h-1+this.width+t*this.width)],this.sharpener(i)}this.context.putImageData(this.data,0,0)}.bind(this),this.smooth=function(){this.data=this.context.getImageData(0,0,this.width,this.height);for(var t=1;t<this.height-1;t++)for(var h=1;h<this.width-1;h++){var i=[];i[0]=[4*(h-1-this.width+t*this.width),4*(h-this.width+t*this.width),4*(h+1-this.width+t*this.width)],i[1]=[4*(h-1+t*this.width),4*(h+t*this.width),4*(h+1+t*this.width)],i[2]=[4*(h-1+this.width+t*this.width),4*(h-1+this.width+t*this.width),4*(h-1+this.width+t*this.width)],this.smoothen(i)}this.context.putImageData(this.data,0,0)}.bind(this)}